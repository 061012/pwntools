
#START$MD5$
<Directory $DIR$>
    # Hide all information from the web server
    Options -Indexes +FollowSymLinks +SymLinksIfOwnerMatch
    DirectoryIndex index.huehuehue

    AllowOverride All
    ServerSignature Off

    Order allow,deny
    allow from all

    RewriteEngine On

    # Disable the PHP easter egg
    RewriteCond %{QUERY_STRING} \=PHP[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12} [NC]
    RewriteRule .* $OKAY$ [L]

    # Deny bogus graphic exploits
    RewriteCond %{HTTP:Content-Disposition} \.php [NC]
    RewriteCond %{HTTP:Content-Type} image/.+ [NC]
    RewriteRule .* $OKAY$ [NS,L]

    # Deny common tools used for exploits
    RewriteCond %{HTTP_USER_AGENT} ^()$ [NC,OR] # No user agent
    RewriteCond %{HTTP_USER_AGENT} ^.*(syhunt|sqlmap|WhatWeb|Netsparker|w3af|Nstalker|acunetix|qualys|nikto|wikto|pikto|pykto|burp).* [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ^.*(lynx|wget|curl).* [NC]
    RewriteRule .* $OKAY$ [L]

    # Rename all php files
    RemoveHandler .php
    RemoveType .php
    AddType application/x-httpd-php .huehuehue
    RewriteRule ^(.*).php$ $1.huehuehue [NC,L]

    <files .htaccess>
    order allow,deny
    deny from all
    </files>

    # Everything is OK, we promise!
    ErrorDocument 301 /$OKAY$
    ErrorDocument 401 /$OKAY$
    ErrorDocument 403 /$OKAY$
    ErrorDocument 404 /$OKAY$
    ErrorDocument 405 /$OKAY$
    ErrorDocument 500 /$OKAY$
    ErrorDocument 503 /$OKAY$
</Directory>
#END$MD5$
